# Level 02

## 目的
ユーザー `flag02` の権限で `getflag` コマンドを実行し、フラグを取得する。

## 手順と解説

### 1. 情報収集

`level02` ユーザーでログイン後、ホームディレクトリを確認します。

```bash
ls -l
```
出力:
```text
----r--r-- 1 flag02  level02 8302 Aug 30  2015 level02.pcap
```
パケットキャプチャファイル `level02.pcap` が見つかります。このファイルを解析することで、過去に行われた通信内容（パスワード入力など）を特定できます。

### 2. Wireshark による解析

この pcap ファイルを Wireshark で開き、以下の手順で解析を行います。
```bash
wireshark level02/resources/level02.pcap
```


1.  **TCPストリームの追跡**:
    パケットリストから任意のパケットを右クリックし、**[Follow] -> [TCP Stream]** を選択します。
    これにより、クライアントとサーバー間のやり取りがチャット形式で表示されます。

2.  **入力内容の確認**:
    `Password:` の後に続く入力内容を確認します。ASCII表示では以下のように見えます。
    `ft_wa n d r . . . N D R e l . L 0 L`
    （`.` の部分は表示不可能な制御文字です）

3.  **Hex Dump モードへの切り替え**:
    正確な入力を把握するため、画面下部の表示形式を `ASCII` から **`Hex Dump`** に切り替えます。
    すると、文字の間に `7f` という16進数値が混ざっていることがわかります。

### 3. パスワードの復元

Wireshark で確認できた 16進数（HEX）データを解釈します。
`7f` は **DEL (Delete)** キーを意味しており、ターミナル上では「直前の1文字を削除する（バックスペース）」として動作します。

**入力の推移**:
- `f`, `t`, `_`, `w`, `a` まで入力
- `n`, `d`, `r` と入力
- `7f`, `7f`, `7f` (3回削除) -> `n`, `d`, `r` が消える
- `N`, `D`, `R`, `e` と入力
- `l` と入力
- `7f` (1回削除) -> `l` が消える
- `L`, `0`, `L` と入力
- `0d` (Enter)

**最終的なパスワード**:
`ft_waNDReL0L`

### 4. フラグの取得

解析したパスワードを用いて `flag02` ユーザーに切り替え、フラグを取得します。

```bash
su flag02
# Password: ft_waNDReL0L
getflag
```

## 結果

### flag02 のパスワード
`ft_waNDReL0L`

### トークン (Flag)
`kooda2puivaav1idi4f57q8iq`
